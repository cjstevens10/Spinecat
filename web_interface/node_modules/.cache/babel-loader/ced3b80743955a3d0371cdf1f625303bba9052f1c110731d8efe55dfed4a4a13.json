{"ast":null,"code":"import _objectSpread from\"/Users/cooperstevens/Documents/CursorWorkspace copy/Spinecat/web_interface/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef}from'react';import{motion,AnimatePresence}from'framer-motion';import{X,BookOpen,CheckCircle,Search,Loader2}from'lucide-react';import{apiService}from'../services/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AlternativesModal=_ref=>{let{isOpen,onClose,currentBook,onBookSwitched,onScrollToBook}=_ref;const[alternatives,setAlternatives]=useState([]);const[isLoading,setIsLoading]=useState(false);const[searchQuery,setSearchQuery]=useState('');const[searchResults,setSearchResults]=useState([]);const[isSearching,setIsSearching]=useState(false);const alternativesRef=useRef(null);// Calculate match score between two book titles (for search results only)\nconst calculateMatchScore=(searchTitle,bookTitle)=>{const search=searchTitle.toLowerCase().trim();const book=bookTitle.toLowerCase().trim();// Exact match\nif(search===book){return{score:1.0,type:'exact'};}// Contains match\nif(search.includes(book)||book.includes(search)){const overlap=Math.min(search.length,book.length)/Math.max(search.length,book.length);if(overlap>0.8)return{score:0.9,type:'strong'};if(overlap>0.6)return{score:0.8,type:'strong'};if(overlap>0.4)return{score:0.7,type:'moderate'};return{score:0.6,type:'moderate'};}// Word-based matching\nconst searchWords=search.split(/\\s+/).filter(w=>w.length>2);const bookWords=book.split(/\\s+/).filter(w=>w.length>2);if(searchWords.length===0||bookWords.length===0){return{score:0.3,type:'weak'};}const commonWords=searchWords.filter(word=>bookWords.includes(word));const wordScore=commonWords.length/Math.max(searchWords.length,bookWords.length);if(wordScore>0.7)return{score:0.8,type:'strong'};if(wordScore>0.5)return{score:0.7,type:'moderate'};if(wordScore>0.3)return{score:0.6,type:'moderate'};if(wordScore>0.1)return{score:0.4,type:'weak'};return{score:0.2,type:'poor'};};// Load alternatives when modal opens\nuseEffect(()=>{if(isOpen&&currentBook){const loadAlternatives=async()=>{setIsLoading(true);try{// Use the actual backend pipeline to get alternatives with real scores\n// This ensures we get the same scoring and matching logic as the initial processing\nconst response=await fetch(\"\".concat(apiService.getBaseUrl(),\"/api/alternatives?ocr_text=\").concat(encodeURIComponent(currentBook.ocr_text),\"&limit=10\"));if(!response.ok){throw new Error(\"HTTP error! status: \".concat(response.status));}const data=await response.json();console.log('ðŸ” Raw response from alternatives API:',data);if(!data.success||!Array.isArray(data.results)){console.warn('Alternatives API returned invalid data:',data);console.warn('data.success:',data.success);console.warn('data.results type:',typeof data.results);console.warn('data.results is array:',Array.isArray(data.results));setAlternatives([]);return;}console.log('ðŸ” Data validation passed, processing',data.results.length,'results');// Convert backend results to alternative matches with REAL scores\nconst alternativesList=data.results.map((book,index)=>{console.log(\"\\uD83D\\uDD0D Processing book \".concat(index,\":\"),book);// Ensure book has required properties\nif(!book||typeof book.title!=='string'){console.warn('Invalid book data:',book);return null;}// Use the ACTUAL backend scores - no fake calculations!\nconst alternative={book:{key:book.key,title:book.title,author_name:book.author_name,first_publish_year:book.first_publish_year,publisher:book.publisher},match_score:book.match_score,// REAL score from backend\nmatch_type:book.match_type// REAL type from backend\n};console.log(\"\\uD83D\\uDD0D Created alternative \".concat(index,\":\"),alternative);return alternative;}).filter(item=>{if(item===null)return false;// Only remove exact duplicates, keep everything else\nconst currentTitle=currentBook.title.toLowerCase();const alternativeTitle=item.book.title.toLowerCase();if(currentTitle===alternativeTitle){console.log(\"\\uD83D\\uDD0D Filtering out exact duplicate: \".concat(alternativeTitle));return false;}console.log(\"\\uD83D\\uDD0D Keeping alternative: \".concat(alternativeTitle));return true;});// Sort by match score (highest first) - using REAL scores\nalternativesList.sort((a,b)=>b.match_score-a.match_score);console.log('Loaded alternatives with REAL backend scores:',alternativesList);setAlternatives(alternativesList);}catch(error){console.error('Failed to load alternatives:',error);setAlternatives([]);}finally{setIsLoading(false);}};loadAlternatives();}},[isOpen,currentBook]);const handleSearch=async()=>{if(!searchQuery.trim())return;setIsSearching(true);try{const results=await apiService.searchBooks(searchQuery,10);// Ensure results is an array\nif(Array.isArray(results)){// Calculate match scores for search results\nconst scoredResults=results.map(book=>{const matchResult=calculateMatchScore(searchQuery,book.title);// Use realistic score range for search results too\nconst realisticScore=Math.min(0.95,Math.max(0.6,matchResult.score));return _objectSpread(_objectSpread({},book),{},{_matchScore:realisticScore,_matchType:matchResult.type});}).filter(book=>{// Filter out books that are too similar to the current book\nreturn!currentBook.title.toLowerCase().includes(book.title.toLowerCase())&&!book.title.toLowerCase().includes(currentBook.title.toLowerCase());});// Sort by match score (highest first)\nscoredResults.sort((a,b)=>b._matchScore-a._matchScore);setSearchResults(scoredResults);}else{console.warn('Search results is not an array:',results);setSearchResults([]);}}catch(error){console.error('Search failed:',error);setSearchResults([]);}finally{setIsSearching(false);}};const handleSwitchBook=alternative=>{// Create a new BookMatch with the alternative book data\nconst newBook=_objectSpread(_objectSpread({},currentBook),{},{title:alternative.book.title,author_name:Array.isArray(alternative.book.author_name)?alternative.book.author_name:[alternative.book.author_name||'Unknown Author'],first_publish_year:alternative.book.first_publish_year,publisher:alternative.book.publisher||'',match_score:alternative.match_score,match_type:alternative.match_type,open_library_id:alternative.book.key,// Preserve the original OCR text to maintain context\nocr_text:currentBook.ocr_text});console.log('Switching to book:',alternative.book.title,'with score:',alternative.match_score);onBookSwitched(newBook);onClose();};// Scroll to a specific book in the alternatives list\nconst scrollToBook=bookTitle=>{if(!alternativesRef.current)return;const alternativesContainer=alternativesRef.current;const bookElements=alternativesContainer.querySelectorAll('[data-book-title]');Array.from(bookElements).forEach(element=>{if(element instanceof HTMLElement&&element.dataset.bookTitle===bookTitle){element.scrollIntoView({behavior:'smooth',block:'center',inline:'nearest'});// Add highlight effect\nelement.classList.add('ring-2','ring-blue-400','ring-opacity-75');setTimeout(()=>{element.classList.remove('ring-2','ring-blue-400','ring-opacity-75');},2000);}});// Notify parent component\nif(onScrollToBook){onScrollToBook(bookTitle);}};// Auto-scroll to current book when alternatives load\nuseEffect(()=>{if(alternatives.length>0&&currentBook){// Small delay to ensure DOM is rendered\nsetTimeout(()=>{scrollToBook(currentBook.title);},100);}},[alternatives,currentBook]);// Expose scroll function to parent component\nconst scrollToBookByTitle=bookTitle=>{scrollToBook(bookTitle);};// Make function available globally for parent component access\nuseEffect(()=>{window.scrollToBookInAlternativesModal=scrollToBookByTitle;return()=>{delete window.scrollToBookInAlternativesModal;};},[]);const getMatchTypeColor=matchType=>{switch(matchType){case'exact':return'bg-green-900/50 text-green-300 border-green-700';case'strong':return'bg-blue-900/50 text-blue-300 border-blue-700';case'moderate':return'bg-yellow-900/50 text-yellow-300 border-yellow-700';case'weak':case'poor':return'bg-red-900/50 text-red-300 border-red-700';default:return'bg-slate-700 text-slate-300 border-slate-600';}};const getMatchTypeLabel=matchType=>{switch(matchType){case'exact':return'Perfect Match';case'strong':return'Strong Match';case'moderate':return'Moderate Match';case'weak':return'Weak Match';case'poor':return'Poor Match';default:return'Unknown';}};if(!isOpen)return null;return/*#__PURE__*/_jsx(AnimatePresence,{children:/*#__PURE__*/_jsx(motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\",onClick:onClose,children:/*#__PURE__*/_jsxs(motion.div,{initial:{scale:0.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0.9,opacity:0},className:\"bg-slate-800 rounded-2xl shadow-xl border border-slate-600 max-w-4xl w-full max-h-[90vh] flex flex-col\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-6 border-b border-slate-600\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-white\",children:\"Possible Alternatives\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-slate-400 mt-1\",children:[\"Current: \",/*#__PURE__*/_jsx(\"span\",{className:\"text-white font-medium\",children:currentBook.title})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"p-2 hover:bg-slate-700 rounded-lg transition-colors duration-200\",children:/*#__PURE__*/_jsx(X,{className:\"w-6 h-6 text-slate-400\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-6 border-b border-slate-600\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search for other books...\",value:searchQuery,onChange:e=>setSearchQuery(e.target.value),onKeyPress:e=>e.key==='Enter'&&handleSearch(),className:\"flex-1 input-field\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSearch,disabled:isSearching||!searchQuery.trim(),className:\"btn-primary px-6 disabled:opacity-50 disabled:cursor-not-allowed\",children:isSearching?/*#__PURE__*/_jsx(Loader2,{className:\"w-4 h-4 animate-spin\"}):/*#__PURE__*/_jsx(Search,{className:\"w-4 h-4\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 overflow-y-auto custom-scrollbar\",children:isLoading?/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center py-12\",children:[/*#__PURE__*/_jsx(Loader2,{className:\"w-8 h-8 animate-spin text-blue-400\"}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-3 text-slate-400\",children:\"Loading alternatives...\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"h-full flex flex-col\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-6 pb-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-slate-700/50 rounded-lg p-4 border border-slate-600\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3 mb-3\",children:[/*#__PURE__*/_jsx(BookOpen,{className:\"w-5 h-5 text-blue-400\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-white\",children:\"Current Selection\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-slate-800 rounded-lg p-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-white mb-2\",children:currentBook.title}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-slate-300 text-sm mb-2\",children:[\"by \",Array.isArray(currentBook.author_name)?currentBook.author_name.join(', '):currentBook.author_name||'Unknown Author']}),currentBook.first_publish_year&&/*#__PURE__*/_jsx(\"p\",{className:\"text-slate-400 text-sm\",children:currentBook.first_publish_year}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-xs bg-blue-900/50 text-blue-300 px-2 py-1 rounded border border-blue-700\",children:\"Current Match\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs bg-slate-700 text-slate-300 px-2 py-1 rounded\",children:[Math.round(currentBook.match_score*100),\"%\"]})]})]})]})}),/*#__PURE__*/_jsx(\"div\",{ref:alternativesRef,className:\"px-6 pb-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-semibold text-white mb-4 sticky top-0 bg-slate-900 py-2 z-10\",children:[\"Alternative Matches (\",alternatives.length,\")\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-slate-400 mb-4\",children:\"Using actual backend pipeline scores. Percentages show real match confidence from the matching algorithm.\"}),alternatives.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8 text-slate-400\",children:[/*#__PURE__*/_jsx(BookOpen,{className:\"w-12 h-12 mx-auto mb-3 text-slate-500\"}),/*#__PURE__*/_jsx(\"p\",{children:\"No alternatives found\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-slate-500 mt-1\",children:\"Try searching for a different book\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:alternatives.map((alternative,index)=>/*#__PURE__*/_jsxs(motion.div,{\"data-book-title\":alternative.book.title,initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:index*0.1},className:\"bg-slate-700/50 rounded-lg p-4 border border-slate-600 hover:border-slate-500 transition-colors duration-200\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-white text-sm mb-1 truncate\",children:alternative.book.title}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-slate-300\",children:[\"by \",Array.isArray(alternative.book.author_name)?alternative.book.author_name.join(', '):alternative.book.author_name||'Unknown Author']})]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs px-2 py-1 rounded-full ml-2 border \".concat(getMatchTypeColor(alternative.match_type)),children:getMatchTypeLabel(alternative.match_type)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between text-xs text-slate-400 mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[alternative.book.first_publish_year&&/*#__PURE__*/_jsx(\"span\",{children:alternative.book.first_publish_year}),alternative.book.publisher&&/*#__PURE__*/_jsx(\"span\",{className:\"truncate max-w-[100px]\",title:alternative.book.publisher,children:alternative.book.publisher})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs bg-slate-700 px-2 py-1 rounded text-slate-300\",children:[Math.round(alternative.match_score*100),\"%\"]})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleSwitchBook(alternative),className:\"w-full btn-primary text-sm py-2 flex items-center justify-center space-x-2\",children:[/*#__PURE__*/_jsx(CheckCircle,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Switch to This Book\"})]})]},alternative.book.key))})]}),searchResults.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-8\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-semibold text-white mb-4 sticky top-0 bg-slate-900 py-2 z-10\",children:[\"Search Results (\",searchResults.length,\")\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-slate-400 mb-4\",children:\"Manual search results. Percentages show calculated similarity to search query.\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:searchResults.map((book,index)=>/*#__PURE__*/_jsxs(motion.div,{\"data-book-title\":book.title,initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:index*0.1},className:\"bg-slate-700/50 rounded-lg p-4 border border-slate-600 hover:border-slate-500 transition-colors duration-200\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-white text-sm mb-1 truncate\",children:book.title}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-slate-300\",children:[\"by \",Array.isArray(book.author_name)?book.author_name.join(', '):book.author_name||'Unknown Author']})]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs px-2 py-1 rounded-full ml-2 border \".concat(getMatchTypeColor(book._matchType||'moderate')),children:getMatchTypeLabel(book._matchType||'moderate')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between text-xs text-slate-400 mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[book.first_publish_year&&/*#__PURE__*/_jsx(\"span\",{children:book.first_publish_year}),book.publisher&&/*#__PURE__*/_jsx(\"span\",{className:\"truncate max-w-[100px]\",title:book.publisher,children:book.publisher})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs bg-slate-700 px-2 py-1 rounded text-slate-300\",children:[Math.round(book._matchScore*100),\"%\"]})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleSwitchBook({book,match_score:book._matchScore||0.6,match_type:book._matchType||'moderate'}),className:\"w-full btn-secondary text-sm py-2 flex items-center justify-center space-x-2\",children:[/*#__PURE__*/_jsx(CheckCircle,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Switch to This Book\"})]})]},book.key))})]})]})})]})})]})})});};export default AlternativesModal;","map":{"version":3,"names":["React","useState","useEffect","useRef","motion","AnimatePresence","X","BookOpen","CheckCircle","Search","Loader2","apiService","jsx","_jsx","jsxs","_jsxs","AlternativesModal","_ref","isOpen","onClose","currentBook","onBookSwitched","onScrollToBook","alternatives","setAlternatives","isLoading","setIsLoading","searchQuery","setSearchQuery","searchResults","setSearchResults","isSearching","setIsSearching","alternativesRef","calculateMatchScore","searchTitle","bookTitle","search","toLowerCase","trim","book","score","type","includes","overlap","Math","min","length","max","searchWords","split","filter","w","bookWords","commonWords","word","wordScore","loadAlternatives","response","fetch","concat","getBaseUrl","encodeURIComponent","ocr_text","ok","Error","status","data","json","console","log","success","Array","isArray","results","warn","alternativesList","map","index","title","alternative","key","author_name","first_publish_year","publisher","match_score","match_type","item","currentTitle","alternativeTitle","sort","a","b","error","handleSearch","searchBooks","scoredResults","matchResult","realisticScore","_objectSpread","_matchScore","_matchType","handleSwitchBook","newBook","open_library_id","scrollToBook","current","alternativesContainer","bookElements","querySelectorAll","from","forEach","element","HTMLElement","dataset","scrollIntoView","behavior","block","inline","classList","add","setTimeout","remove","scrollToBookByTitle","window","scrollToBookInAlternativesModal","getMatchTypeColor","matchType","getMatchTypeLabel","children","div","initial","opacity","animate","exit","className","onClick","scale","e","stopPropagation","placeholder","value","onChange","target","onKeyPress","disabled","join","round","ref","y","transition","delay"],"sources":["/Users/cooperstevens/Documents/CursorWorkspace copy/Spinecat/web_interface/src/components/AlternativesModal.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { X, BookOpen, CheckCircle, Search, Loader2 } from 'lucide-react';\n\nimport { BookMatch, OpenLibraryBook } from '../types';\nimport { apiService } from '../services/api';\n\ninterface AlternativesModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  currentBook: BookMatch;\n  onBookSwitched: (newBook: BookMatch) => void;\n  onScrollToBook?: (bookTitle: string) => void;\n}\n\ninterface AlternativeMatch {\n  book: OpenLibraryBook;\n  match_score: number;\n  match_type: 'exact' | 'strong' | 'moderate' | 'weak' | 'poor';\n}\n\nconst AlternativesModal: React.FC<AlternativesModalProps> = ({\n  isOpen,\n  onClose,\n  currentBook,\n  onBookSwitched,\n  onScrollToBook\n}) => {\n  const [alternatives, setAlternatives] = useState<AlternativeMatch[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [searchResults, setSearchResults] = useState<OpenLibraryBook[]>([]);\n  const [isSearching, setIsSearching] = useState(false);\n  const alternativesRef = useRef<HTMLDivElement>(null);\n\n  // Calculate match score between two book titles (for search results only)\n  const calculateMatchScore = (searchTitle: string, bookTitle: string): { score: number; type: 'exact' | 'strong' | 'moderate' | 'weak' | 'poor' } => {\n    const search = searchTitle.toLowerCase().trim();\n    const book = bookTitle.toLowerCase().trim();\n    \n    // Exact match\n    if (search === book) {\n      return { score: 1.0, type: 'exact' };\n    }\n    \n    // Contains match\n    if (search.includes(book) || book.includes(search)) {\n      const overlap = Math.min(search.length, book.length) / Math.max(search.length, book.length);\n      if (overlap > 0.8) return { score: 0.9, type: 'strong' };\n      if (overlap > 0.6) return { score: 0.8, type: 'strong' };\n      if (overlap > 0.4) return { score: 0.7, type: 'moderate' };\n      return { score: 0.6, type: 'moderate' };\n    }\n    \n    // Word-based matching\n    const searchWords = search.split(/\\s+/).filter(w => w.length > 2);\n    const bookWords = book.split(/\\s+/).filter(w => w.length > 2);\n    \n    if (searchWords.length === 0 || bookWords.length === 0) {\n      return { score: 0.3, type: 'weak' };\n    }\n    \n    const commonWords = searchWords.filter(word => bookWords.includes(word));\n    const wordScore = commonWords.length / Math.max(searchWords.length, bookWords.length);\n    \n    if (wordScore > 0.7) return { score: 0.8, type: 'strong' };\n    if (wordScore > 0.5) return { score: 0.7, type: 'moderate' };\n    if (wordScore > 0.3) return { score: 0.6, type: 'moderate' };\n    if (wordScore > 0.1) return { score: 0.4, type: 'weak' };\n    \n    return { score: 0.2, type: 'poor' };\n  };\n\n  // Load alternatives when modal opens\n  useEffect(() => {\n    if (isOpen && currentBook) {\n      const loadAlternatives = async () => {\n        setIsLoading(true);\n        try {\n          // Use the actual backend pipeline to get alternatives with real scores\n          // This ensures we get the same scoring and matching logic as the initial processing\n          const response = await fetch(`${apiService.getBaseUrl()}/api/alternatives?ocr_text=${encodeURIComponent(currentBook.ocr_text)}&limit=10`);\n          \n          if (!response.ok) {\n            throw new Error(`HTTP error! status: ${response.status}`);\n          }\n          \n          const data = await response.json();\n          console.log('ðŸ” Raw response from alternatives API:', data);\n          \n          if (!data.success || !Array.isArray(data.results)) {\n            console.warn('Alternatives API returned invalid data:', data);\n            console.warn('data.success:', data.success);\n            console.warn('data.results type:', typeof data.results);\n            console.warn('data.results is array:', Array.isArray(data.results));\n            setAlternatives([]);\n            return;\n          }\n          \n          console.log('ðŸ” Data validation passed, processing', data.results.length, 'results');\n          \n          // Convert backend results to alternative matches with REAL scores\n          const alternativesList: AlternativeMatch[] = data.results\n            .map((book: any, index: number) => {\n              console.log(`ðŸ” Processing book ${index}:`, book);\n              \n              // Ensure book has required properties\n              if (!book || typeof book.title !== 'string') {\n                console.warn('Invalid book data:', book);\n                return null;\n              }\n              \n              // Use the ACTUAL backend scores - no fake calculations!\n              const alternative: AlternativeMatch = {\n                book: {\n                  key: book.key,\n                  title: book.title,\n                  author_name: book.author_name,\n                  first_publish_year: book.first_publish_year,\n                  publisher: book.publisher\n                },\n                match_score: book.match_score, // REAL score from backend\n                match_type: book.match_type    // REAL type from backend\n              };\n              \n              console.log(`ðŸ” Created alternative ${index}:`, alternative);\n              return alternative;\n            })\n            .filter((item: any): item is AlternativeMatch => {\n              if (item === null) return false;\n              \n              // Only remove exact duplicates, keep everything else\n              const currentTitle = currentBook.title.toLowerCase();\n              const alternativeTitle = item.book.title.toLowerCase();\n              \n              if (currentTitle === alternativeTitle) {\n                console.log(`ðŸ” Filtering out exact duplicate: ${alternativeTitle}`);\n                return false;\n              }\n              \n              console.log(`ðŸ” Keeping alternative: ${alternativeTitle}`);\n              return true;\n            });\n          \n          // Sort by match score (highest first) - using REAL scores\n          alternativesList.sort((a, b) => b.match_score - a.match_score);\n          \n          console.log('Loaded alternatives with REAL backend scores:', alternativesList);\n          setAlternatives(alternativesList);\n        } catch (error) {\n          console.error('Failed to load alternatives:', error);\n          setAlternatives([]);\n        } finally {\n          setIsLoading(false);\n        }\n      };\n      \n      loadAlternatives();\n    }\n  }, [isOpen, currentBook]);\n\n  const handleSearch = async () => {\n    if (!searchQuery.trim()) return;\n    \n    setIsSearching(true);\n    try {\n      const results = await apiService.searchBooks(searchQuery, 10);\n      \n      // Ensure results is an array\n      if (Array.isArray(results)) {\n        // Calculate match scores for search results\n        const scoredResults = results.map((book: OpenLibraryBook) => {\n          const matchResult = calculateMatchScore(searchQuery, book.title);\n          \n          // Use realistic score range for search results too\n          const realisticScore = Math.min(0.95, Math.max(0.6, matchResult.score));\n          \n          return {\n            ...book,\n            _matchScore: realisticScore,\n            _matchType: matchResult.type\n          };\n        })\n        .filter(book => {\n          // Filter out books that are too similar to the current book\n          return !currentBook.title.toLowerCase().includes(book.title.toLowerCase()) &&\n                 !book.title.toLowerCase().includes(currentBook.title.toLowerCase());\n        });\n        \n        // Sort by match score (highest first)\n        scoredResults.sort((a: any, b: any) => b._matchScore - a._matchScore);\n        setSearchResults(scoredResults);\n      } else {\n        console.warn('Search results is not an array:', results);\n        setSearchResults([]);\n      }\n    } catch (error) {\n      console.error('Search failed:', error);\n      setSearchResults([]);\n    } finally {\n      setIsSearching(false);\n    }\n  };\n\n  const handleSwitchBook = (alternative: AlternativeMatch) => {\n    // Create a new BookMatch with the alternative book data\n    const newBook: BookMatch = {\n      ...currentBook,\n      title: alternative.book.title,\n      author_name: Array.isArray(alternative.book.author_name) ? alternative.book.author_name : [alternative.book.author_name || 'Unknown Author'],\n      first_publish_year: alternative.book.first_publish_year,\n      publisher: alternative.book.publisher || '',\n      match_score: alternative.match_score,\n      match_type: alternative.match_type,\n      open_library_id: alternative.book.key,\n      // Preserve the original OCR text to maintain context\n      ocr_text: currentBook.ocr_text\n    };\n    \n    console.log('Switching to book:', alternative.book.title, 'with score:', alternative.match_score);\n    onBookSwitched(newBook);\n    onClose();\n  };\n\n  // Scroll to a specific book in the alternatives list\n  const scrollToBook = (bookTitle: string) => {\n    if (!alternativesRef.current) return;\n    \n    const alternativesContainer = alternativesRef.current;\n    const bookElements = alternativesContainer.querySelectorAll('[data-book-title]');\n    \n    Array.from(bookElements).forEach((element) => {\n      if (element instanceof HTMLElement && element.dataset.bookTitle === bookTitle) {\n        element.scrollIntoView({ \n          behavior: 'smooth', \n          block: 'center',\n          inline: 'nearest'\n        });\n        // Add highlight effect\n        element.classList.add('ring-2', 'ring-blue-400', 'ring-opacity-75');\n        setTimeout(() => {\n          element.classList.remove('ring-2', 'ring-blue-400', 'ring-opacity-75');\n        }, 2000);\n      }\n    });\n    \n    // Notify parent component\n    if (onScrollToBook) {\n      onScrollToBook(bookTitle);\n    }\n  };\n\n  // Auto-scroll to current book when alternatives load\n  useEffect(() => {\n    if (alternatives.length > 0 && currentBook) {\n      // Small delay to ensure DOM is rendered\n      setTimeout(() => {\n        scrollToBook(currentBook.title);\n      }, 100);\n    }\n  }, [alternatives, currentBook]);\n\n  // Expose scroll function to parent component\n  const scrollToBookByTitle = (bookTitle: string) => {\n    scrollToBook(bookTitle);\n  };\n\n  // Make function available globally for parent component access\n  useEffect(() => {\n    (window as any).scrollToBookInAlternativesModal = scrollToBookByTitle;\n    return () => {\n      delete (window as any).scrollToBookInAlternativesModal;\n    };\n  }, []);\n\n  const getMatchTypeColor = (matchType: string) => {\n    switch (matchType) {\n      case 'exact':\n        return 'bg-green-900/50 text-green-300 border-green-700';\n      case 'strong':\n        return 'bg-blue-900/50 text-blue-300 border-blue-700';\n      case 'moderate':\n        return 'bg-yellow-900/50 text-yellow-300 border-yellow-700';\n      case 'weak':\n      case 'poor':\n        return 'bg-red-900/50 text-red-300 border-red-700';\n      default:\n        return 'bg-slate-700 text-slate-300 border-slate-600';\n    }\n  };\n\n  const getMatchTypeLabel = (matchType: string) => {\n    switch (matchType) {\n      case 'exact':\n        return 'Perfect Match';\n      case 'strong':\n        return 'Strong Match';\n      case 'moderate':\n        return 'Moderate Match';\n      case 'weak':\n        return 'Weak Match';\n      case 'poor':\n        return 'Poor Match';\n      default:\n        return 'Unknown';\n    }\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <AnimatePresence>\n      <motion.div\n        initial={{ opacity: 0 }}\n        animate={{ opacity: 1 }}\n        exit={{ opacity: 0 }}\n        className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\"\n        onClick={onClose}\n      >\n        <motion.div\n          initial={{ scale: 0.9, opacity: 0 }}\n          animate={{ scale: 1, opacity: 1 }}\n          exit={{ scale: 0.9, opacity: 0 }}\n          className=\"bg-slate-800 rounded-2xl shadow-xl border border-slate-600 max-w-4xl w-full max-h-[90vh] flex flex-col\"\n          onClick={(e) => e.stopPropagation()}\n        >\n          {/* Header */}\n          <div className=\"flex items-center justify-between p-6 border-b border-slate-600\">\n            <div>\n              <h2 className=\"text-2xl font-bold text-white\">Possible Alternatives</h2>\n              <p className=\"text-slate-400 mt-1\">\n                Current: <span className=\"text-white font-medium\">{currentBook.title}</span>\n              </p>\n            </div>\n            <button\n              onClick={onClose}\n              className=\"p-2 hover:bg-slate-700 rounded-lg transition-colors duration-200\"\n            >\n              <X className=\"w-6 h-6 text-slate-400\" />\n            </button>\n          </div>\n\n          {/* Search Bar */}\n          <div className=\"p-6 border-b border-slate-600\">\n            <div className=\"flex space-x-3\">\n              <input\n                type=\"text\"\n                placeholder=\"Search for other books...\"\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n                onKeyPress={(e) => e.key === 'Enter' && handleSearch()}\n                className=\"flex-1 input-field\"\n              />\n              <button\n                onClick={handleSearch}\n                disabled={isSearching || !searchQuery.trim()}\n                className=\"btn-primary px-6 disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                {isSearching ? (\n                  <Loader2 className=\"w-4 h-4 animate-spin\" />\n                ) : (\n                  <Search className=\"w-4 h-4\" />\n                )}\n              </button>\n            </div>\n          </div>\n\n          {/* Content */}\n          <div className=\"flex-1 overflow-y-auto custom-scrollbar\">\n            {isLoading ? (\n              <div className=\"flex items-center justify-center py-12\">\n                <Loader2 className=\"w-8 h-8 animate-spin text-blue-400\" />\n                <span className=\"ml-3 text-slate-400\">Loading alternatives...</span>\n              </div>\n            ) : (\n              <div className=\"h-full flex flex-col\">\n                {/* Current Book - Fixed at top */}\n                <div className=\"p-6 pb-4\">\n                  <div className=\"bg-slate-700/50 rounded-lg p-4 border border-slate-600\">\n                    <div className=\"flex items-center space-x-3 mb-3\">\n                      <BookOpen className=\"w-5 h-5 text-blue-400\" />\n                      <h3 className=\"text-lg font-semibold text-white\">Current Selection</h3>\n                    </div>\n                    <div className=\"bg-slate-800 rounded-lg p-4\">\n                      <h4 className=\"font-medium text-white mb-2\">{currentBook.title}</h4>\n                      <p className=\"text-slate-300 text-sm mb-2\">\n                        by {Array.isArray(currentBook.author_name) ? currentBook.author_name.join(', ') : currentBook.author_name || 'Unknown Author'}\n                      </p>\n                      {currentBook.first_publish_year && (\n                        <p className=\"text-slate-400 text-sm\">{currentBook.first_publish_year}</p>\n                      )}\n                      <div className=\"mt-3 flex items-center space-x-2\">\n                        <span className=\"text-xs bg-blue-900/50 text-blue-300 px-2 py-1 rounded border border-blue-700\">\n                          Current Match\n                        </span>\n                        <span className=\"text-xs bg-slate-700 text-slate-300 px-2 py-1 rounded\">\n                          {Math.round(currentBook.match_score * 100)}%\n                        </span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Alternatives Section */}\n                <div \n                  ref={alternativesRef} \n                  className=\"px-6 pb-6\"\n                >\n                  <div className=\"space-y-4\">\n                    {/* Alternatives */}\n                    <div>\n                      <h3 className=\"text-lg font-semibold text-white mb-4 sticky top-0 bg-slate-900 py-2 z-10\">\n                        Alternative Matches ({alternatives.length})\n                      </h3>\n                      <p className=\"text-xs text-slate-400 mb-4\">\n                        Using actual backend pipeline scores. Percentages show real match confidence from the matching algorithm.\n                      </p>\n                      \n                      {alternatives.length === 0 ? (\n                        <div className=\"text-center py-8 text-slate-400\">\n                          <BookOpen className=\"w-12 h-12 mx-auto mb-3 text-slate-500\" />\n                          <p>No alternatives found</p>\n                          <p className=\"text-sm text-slate-500 mt-1\">Try searching for a different book</p>\n                        </div>\n                      ) : (\n                        <div className=\"space-y-3\">\n                          {alternatives.map((alternative, index) => (\n                            <motion.div\n                              key={alternative.book.key}\n                              data-book-title={alternative.book.title}\n                              initial={{ opacity: 0, y: 10 }}\n                              animate={{ opacity: 1, y: 0 }}\n                              transition={{ delay: index * 0.1 }}\n                              className=\"bg-slate-700/50 rounded-lg p-4 border border-slate-600 hover:border-slate-500 transition-colors duration-200\"\n                            >\n                              <div className=\"flex items-start justify-between mb-3\">\n                                <div className=\"flex-1 min-w-0\">\n                                  <h4 className=\"font-medium text-white text-sm mb-1 truncate\">\n                                    {alternative.book.title}\n                                  </h4>\n                                  <p className=\"text-xs text-slate-300\">\n                                    by {Array.isArray(alternative.book.author_name) ? alternative.book.author_name.join(', ') : alternative.book.author_name || 'Unknown Author'}\n                                  </p>\n                                </div>\n                                <span className={`text-xs px-2 py-1 rounded-full ml-2 border ${getMatchTypeColor(alternative.match_type)}`}>\n                                  {getMatchTypeLabel(alternative.match_type)}\n                                </span>\n                              </div>\n\n                              <div className=\"flex items-center justify-between text-xs text-slate-400 mb-3\">\n                                <div className=\"flex items-center space-x-3\">\n                                  {alternative.book.first_publish_year && (\n                                    <span>{alternative.book.first_publish_year}</span>\n                                  )}\n                                  {alternative.book.publisher && (\n                                    <span className=\"truncate max-w-[100px]\" title={alternative.book.publisher}>\n                                      {alternative.book.publisher}\n                                    </span>\n                                  )}\n                                </div>\n                                <span className=\"text-xs bg-slate-700 px-2 py-1 rounded text-slate-300\">\n                                  {Math.round(alternative.match_score * 100)}%\n                                </span>\n                              </div>\n\n                              <button\n                                onClick={() => handleSwitchBook(alternative)}\n                                className=\"w-full btn-primary text-sm py-2 flex items-center justify-center space-x-2\"\n                              >\n                                <CheckCircle className=\"w-4 h-4\" />\n                                <span>Switch to This Book</span>\n                              </button>\n                            </motion.div>\n                          ))}\n                        </div>\n                      )}\n                    </div>\n\n                    {/* Search Results */}\n                    {searchResults.length > 0 && (\n                      <div className=\"mt-8\">\n                        <h3 className=\"text-lg font-semibold text-white mb-4 sticky top-0 bg-slate-900 py-2 z-10\">\n                          Search Results ({searchResults.length})\n                        </h3>\n                        <p className=\"text-xs text-slate-400 mb-4\">\n                          Manual search results. Percentages show calculated similarity to search query.\n                        </p>\n                        <div className=\"space-y-3\">\n                          {searchResults.map((book, index) => (\n                            <motion.div\n                              key={book.key}\n                              data-book-title={book.title}\n                              initial={{ opacity: 0, y: 10 }}\n                              animate={{ opacity: 1, y: 0 }}\n                              transition={{ delay: index * 0.1 }}\n                              className=\"bg-slate-700/50 rounded-lg p-4 border border-slate-600 hover:border-slate-500 transition-colors duration-200\"\n                            >\n                              <div className=\"flex items-start justify-between mb-3\">\n                                <div className=\"flex-1 min-w-0\">\n                                  <h4 className=\"font-medium text-white text-sm mb-1 truncate\">\n                                    {book.title}\n                                  </h4>\n                                  <p className=\"text-xs text-slate-300\">\n                                    by {Array.isArray(book.author_name) ? book.author_name.join(', ') : book.author_name || 'Unknown Author'}\n                                  </p>\n                                </div>\n                                <span className={`text-xs px-2 py-1 rounded-full ml-2 border ${getMatchTypeColor((book as any)._matchType || 'moderate')}`}>\n                                  {getMatchTypeLabel((book as any)._matchType || 'moderate')}\n                                </span>\n                              </div>\n\n                              <div className=\"flex items-center justify-between text-xs text-slate-400 mb-3\">\n                                <div className=\"flex items-center space-x-3\">\n                                  {book.first_publish_year && (\n                                    <span>{book.first_publish_year}</span>\n                                  )}\n                                  {book.publisher && (\n                                    <span className=\"truncate max-w-[100px]\" title={book.publisher}>\n                                      {book.publisher}\n                                    </span>\n                                  )}\n                                </div>\n                                <span className=\"text-xs bg-slate-700 px-2 py-1 rounded text-slate-300\">\n                                  {Math.round((book as any)._matchScore * 100)}%\n                                </span>\n                              </div>\n\n                              <button\n                                onClick={() => handleSwitchBook({\n                                  book,\n                                  match_score: (book as any)._matchScore || 0.6,\n                                  match_type: (book as any)._matchType || 'moderate'\n                                })}\n                                className=\"w-full btn-secondary text-sm py-2 flex items-center justify-center space-x-2\"\n                              >\n                                <CheckCircle className=\"w-4 h-4\" />\n                                <span>Switch to This Book</span>\n                              </button>\n                            </motion.div>\n                          ))}\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              </div>\n            )}\n          </div>\n        </motion.div>\n      </motion.div>\n    </AnimatePresence>\n  );\n};\n\nexport default AlternativesModal;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}